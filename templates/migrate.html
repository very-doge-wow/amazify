{% extends "base.html" %}
{% block title %}Amazify - Migrate Amazon Playlist{% endblock %}
{% block header %}Amazify - Migrate Amazon Playlist to Spotify{% endblock %}
{% block content %}
<script>
var intervalId = setInterval(function() {
  fetch('/api/progress')
    .then(response => response.json())
    .then(data => document.getElementById('migration').value = data.progress)
    .catch(error => console.error('Error:', error));
}, 500);
</script>

<div class="media fadeitin">
    <div class="mr-4">
        <a href="{{content['url']}}" target="_blank"><img class="media-object" width="150" src="{{content['images'][0]['url']}}" /></a>
    </div>
    <div class="media-body">
      <h4><a class="text-dark nounderline" href="{{content['url']}}" target="_blank">{{content['title']}}</a></h4>
      <label for="migration">Migration progress:</label>
      <progress id="migration" style="width: 100%" value="{{ session['progress'] }}" max="100"></progress>
      <dl class="dl-horizontal">
        <dt>Id</dt><dd>{{content['id']}}</dd>
        <dt>TrackCount</dt><dd>{{content['trackCount']}}</dd>
        <dt>Visibility</dt><dd>{{content['visibility']}}</dd>
        <dt>Duration</dt><dd>{{content['duration']}}</dd>
        <dt>Amazon Url</dt><dd><a href="{{content['url']}}" target="_blank">{{content['url']}}</a></dd>
      </dl>
        <h5>Tracks</h5>
        <ul>
            {% for track in content['tracks']['edges'] %}
            <li>{{ track['node']['artists'][0]['name'] }} - {{ track['node']['title'] }}</li>
            {% endfor %}
        </ul>
    </div>
</div>
{% endblock %}
